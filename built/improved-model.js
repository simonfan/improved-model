//     improved-model
//     (c) simonfan
//     improved-model is licensed under the MIT terms.

define("__improved-model/model-swtch/build-condition",["require","exports","module","object-query","lodash"],function(t,i,e){function o(t){var i=t.split(r),e=s.map(i,function(t){var i={};return s.each(t.split(l),function(t){var e=t.split(a);if(!e[1])throw new Error("No value found for "+o+" criterion.");var o=e[0],n=e[1].split(c);i[o]=n.length>1?n:n[0]}),i});return e}var n=t("object-query"),s=t("lodash"),r=/\s*\|\|\s*/g,l=/\s*&&\s*/g,a=/\s*:\s*/g,c=/\s*\|\s*/g;e.exports=function(t,i){return s.isString(i)&&(i=o(i)),s.partial(n(i),t.attributes)}}),define("__improved-model/model-swtch/build-callback",["require","exports","module","lodash"],function(t,i,e){function o(t,i){t.set(i)}var n=t("lodash");e.exports=function(t,i){return n.isFunction(i)?n.partial(i,t):n.partial(o,t,i)}}),define("__improved-model/model-swtch/index",["require","exports","module","swtch","lodash","./build-condition","./build-callback"],function(t,i,e){{var o=t("swtch"),n=t("lodash"),s=t("./build-condition"),r=t("./build-callback"),l=o.prototype.initialize,a=o.prototype.when;e.exports=o.extend({initialize:function(t,i){this.model=i.model;var e;n.isArray(t)?e=t:(e=[],n.each(t,function(t,i){e.push({condition:i,value:t})})),l.call(this,e)},when:function(t,i){var e=n.toArray(arguments);if("default"!==t){var o=s(this.model,t),l=r(this.model,i);e=[o,l].concat(e.slice(2))}return a.apply(this,e)}})}}),define("__improved-model/swtch",["require","exports","module","./model-swtch/index"],function(t,i){var e=t("./model-swtch/index");i.swtch=function(t){var i=e(t,{model:this}),o="all"===this.executionType?i.exec:i.execFirst;return this.on("change",function(t){o.call(i,t.attributes)}),o.call(i,this.attributes),i}}),define("__improved-model/bind-attribute",["require","exports","module","lodash"],function(t,i){function e(t){return t}function o(t,i,e){this.on("change:"+t,function(){this.set(i,e(this.get(t)))},this),this.set(i,e(this.get(t)))}var n=t("lodash");i.bindAttribute=function(t,i,s){n.isArray(i)?(s=s||e,s=n.isString(s)?this[s]:s,n.each(i,function(i){o.call(this,t,i,s)},this)):n.isObject(i)?n.each(i,function(i,e){i=n.isString(i)?this[i]:i,o.call(this,t,e,i)},this):(s=s||e,s=n.isString(s)?this[s]:s,o.call(this,t,i,s))}}),define("improved-model",["require","exports","module","lowercase-backbone","lodash","./__improved-model/swtch","./__improved-model/bind-attribute"],function(t,i,e){var o=t("lowercase-backbone"),n=t("lodash"),s=o.model.prototype.initialize,r=["cases","executionType"],l=e.exports=o.model.extend({initialize:function(t,i){s.apply(this,arguments),i=i||{},n.each(r,function(t){this[t]=i[t]||this[t]},this),this.mainSwtch=this.swtch(this.cases)},executionType:"all",cases:{},when:function(t,i,e){return this.mainSwtch.when(t,i,e),this}});l.assignProto(t("./__improved-model/swtch")).assignProto(t("./__improved-model/bind-attribute"))});